webpackJsonp([25],{"/XGa":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),r=a("pZSb"),c=a.n(r),n=a("8Y6E"),o=a("Fwkz"),d=a("kMOI"),l=a("GyW3"),u=a("bh5B"),h=a("UBjx"),p=a("Faxw"),v=a("rHil"),m=a("ALGc"),f=a("1DHf"),g=a("rGqP"),A=a("63CM"),_=a("HD9R"),S=a("kNDc"),b=a("LgOF"),k=a("NYxO"),C={data:function(){return{showSearch:!1,headerBg:c.a,content:"",address:null,productId:"",productName:"",tags:[],searchList:[]}},directives:{TransferDom:A.a},components:{VHeader:h.a,Group:v.a,XTextarea:m.a,Cell:f.a,Divider:g.a,Scroll:u.a,Popup:_.a,SearchHeader:p.a,Grid:S.a,GridItem:b.a},computed:i()({},Object(k.b)({atlas:"selectPic"})),mounted:function(){var t=window.innerHeight-40-40;Object(l.c)()?t-=34:t-=20,this.$refs.scroll.$el.style.height=t+"px"},methods:i()({back:function(t){var e=this;if(t)return e.setSelectPic([]),void e.$router.go(-1);this.$vux.confirm.show({title:"您正在发布动态，确认要退出吗？",content:" ",onConfirm:function(){e.$router.go(-1)}})},publish:function(){var t=d.b.get("id");if(null==t)return this.$vux.toast.text("请先登录！","middle"),void this.$router.push("/user/login");if(0!==this.atlas.length){var e=[];this.tags.forEach(function(t){e.push(t.id)});var a={content:this.content,atlas:this.atlas.join(";"),productId:this.productId,publisher:t,tagIds:e.join(";")};this.address&&(a.publishLongitude=this.address.longitude,a.publishLatitude=this.address.latitude,a.publishAddress=this.address.address);var s=this;o.a.post(this,"/v1/dynamic",a,function(t){s.$store.commit("SET_MEITU_TAB",1),s.$vux.toast.text("发布成功了~","middle"),d.a.push(s.tags),s.back(!0)})}else this.$vux.toast.text("请至少选择一张图片发布动态！","middle")},changeFile:function(t){var e=this;Object(n.a)(this,t.target.files,function(t){e.pushSelectPic(t[0].downloadPath)}),t.target.value=""},toCamera:function(){this.$refs.camera.dispatchEvent(new MouseEvent("click"))},addTag:function(){this.$router.push("/meiTu/publishDynamic/selectTag")},getAddress:function(){this.$router.push("/meiTu/publishDynamic/getAddress")},linkProduct:function(){this.showSearch=!0,this.submitSearch("")},submitSearch:function(t){var e=this;o.a.get(this,"/v1/product",{name:t},function(t){e.searchList=t})},clickProductItem:function(t,e){this.productId=t,this.productName=e,this.showSearch=!1}},Object(k.c)({setSelectPic:"SET_SELECT_PIC",pushSelectPic:"PUSH_SELECT_PIC"}))},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"publishDynamic-wrapper"},[a("v-header",{attrs:{handleClick:!0},on:{back:t.back}},[a("p",{attrs:{slot:"right"},on:{click:t.publish},slot:"right"},[t._v("发布")])]),t._v(" "),a("scroll",{ref:"scroll",staticStyle:{overflow:"hidden"}},[a("div",[a("group",[a("x-textarea",{staticStyle:{"margin-top":"0"},attrs:{max:200,rows:4,placeholder:"说点什么..."},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),t.address&&t.address.address?a("div",{staticClass:"address"},[a("i",{staticClass:"fa fa-map-marker",staticStyle:{"margin-right":"5px"},attrs:{"aria-hidden":"true"}}),t._v(t._s(t.address.address))]):t._e(),t._v(" "),a("grid",{attrs:{cols:3}},t._l(t.atlas,function(e,s){return a("grid-item",{key:s,nativeOn:{click:function(e){e.stopPropagation(),t.toAmusement(t.item.id)}}},[a("div",{staticClass:"img-item"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e+"-meitu3",expression:"img + '-meitu3'"}]})])])})),t._v(" "),a("cell",{attrs:{title:"关联产品~",value:t.productName,"is-link":""},nativeOn:{click:function(e){t.linkProduct(e)}}},[a("img",{staticStyle:{display:"block","margin-right":"5px"},attrs:{slot:"icon",width:"20",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAuCAMAAABgZ9sFAAAAVFBMVEXx8fHMzMzr6+vn5+fv7+/t7e3d3d2+vr7W1tbHx8eysrKdnZ3p6enk5OTR0dG7u7u3t7ejo6PY2Njh4eHf39/T09PExMSvr6+goKCqqqqnp6e4uLgcLY/OAAAAnklEQVRIx+3RSRLDIAxE0QYhAbGZPNu5/z0zrXHiqiz5W72FqhqtVuuXAl3iOV7iPV/iSsAqZa9BS7YOmMXnNNX4TWGxRMn3R6SxRNgy0bzXOW8EBO8SAClsPdB3psqlvG+Lw7ONXg/pTld52BjgSSkA3PV2OOemjIDcZQWgVvONw60q7sIpR38EnHPSMDQ4MjDjLPozhAkGrVbr/z0ANjAF4AcbXmYAAAAASUVORK5CYII="},slot:"icon"})])],1),t._v(" "),a("div",{staticClass:"topic"},[a("p",{staticStyle:{"font-size":"17px"}},[t._v("选择的话题")]),t._v(" "),a("div",{staticClass:"content"},t._l(t.tags,function(e,s){return a("p",{key:s,staticClass:"tag"},[t._v("#"+t._s(e.name)+"#")])}))])],1)]),t._v(" "),a("div",{staticClass:"bottom"},[a("input",{ref:"camera",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",capture:"camera"},on:{change:t.changeFile}}),t._v(" "),a("div",{staticClass:"icon",on:{click:t.toCamera}},[a("i",{staticClass:"fa fa-camera",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("div",{staticClass:"icon",on:{click:t.addTag}},[a("i",{staticClass:"fa fa-eyedropper",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("div",{staticClass:"icon",on:{click:t.getAddress}},[a("i",{staticClass:"fa fa-map-marker",attrs:{"aria-hidden":"true"}})])]),t._v(" "),a("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[a("popup",{staticClass:"popup-wrapper",attrs:{position:"right",width:"100%"},model:{value:t.showSearch,callback:function(e){t.showSearch=e},expression:"showSearch"}},[a("div",[a("search-header",{on:{submitSearch:t.submitSearch}},[a("p",{attrs:{slot:"button"},on:{click:function(e){t.showSearch=!1}},slot:"button"},[t._v("取消")])]),t._v(" "),a("ul",{staticClass:"search-list"},t._l(t.searchList,function(e){return a("li",{key:e.id,on:{click:function(a){t.clickProductItem(e.id,e.name)}}},[a("p",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),a("p",{staticClass:"feature"},[t._v(t._s(e.feature))])])})),t._v(" "),0===t.searchList.length?a("h4",{staticStyle:{"text-align":"center","margin-top":"30%"}},[t._v("喔噢~没有数据")]):t._e()],1)])],1),t._v(" "),a("router-view")],1)},staticRenderFns:[]};var w=a("VU/8")(C,x,!1,function(t){a("OFTg")},"data-v-dcdefe80",null);e.default=w.exports},OFTg:function(t,e){}});
//# sourceMappingURL=25.98a466c8087c9fec6f35.js.map
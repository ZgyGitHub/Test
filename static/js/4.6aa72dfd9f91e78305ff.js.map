{"version":3,"sources":["webpack:///./src/components/chat/editableDiv.vue","webpack:///./src/components/chat/editableDiv.vue?91cc","webpack:///./src/components/chat/editableDiv.vue?7ec2","webpack:///./src/components/chat/emotionGrid.vue","webpack:///./src/components/chat/emotionGrid.vue?96c6","webpack:///./src/components/chat/emotionGrid.vue?a4aa","webpack:///./node_modules/vux/src/components/wechat-emotion/index.vue","webpack:///./node_modules/vux/src/components/wechat-emotion/index.vue?e3a9","webpack:///./node_modules/vux/src/components/wechat-emotion/index.vue?6129","webpack:///./src/components/chat/chat.vue","webpack:///./src/components/chat/chat.vue?d95a","webpack:///./src/components/chat/chat.vue?c7a1"],"names":["editableDiv","name","props","value","type","String","default","canEdit","Boolean","data","innerText","this","isLocked","watch","newValue","oldValue","_this","$nextTick","setCaretPosition","methods","changeText","$emit","$el","innerHTML","obj","$refs","editDiv","range","window","getSelection","focus","selectAllChildren","collapseToEnd","document","selection","createRange","moveToElementText","collapse","select","getCursortPosition","sel","element","caretOffset","doc","ownerDocument","win","defaultView","parentWindow","rangeCount","getRangeAt","preCaretRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","toString","length","textRange","preCaretTextRange","body","createTextRange","setEndPoint","text","chat_editableDiv","render","_h","$createElement","_self","_c","ref","staticClass","attrs","contenteditable","domProps","_s","on","input","staticRenderFns","components_chat_editableDiv","__webpack_require__","normalizeComponent","ssrContext","emotionGrid","components","Grid","grid","GridItem","grid_item","Slider","slider","emotionList","clickEmotion","chat_emotionGrid","_vm","list","autoPlay","loop","_l","line","index1","key","cols","item","index","nativeOn","click","$event","_v","components_chat_emotionGrid","emotionGrid_normalizeComponent","wechat_emotion","mounted","indexOf","backgroundPositionX","imgHTML","isGif","src","components_wechat_emotion","_t","src_components_wechat_emotion","wechat_emotion_normalizeComponent","chat","showEmotion","mainHeight","inputContent","softHeight","statusBarHeight","marginBottom","computed","extends_default","Object","vuex_esm","created","inputWidth","innerWidth","brower","topHeight","_Native_heightChange","height","visibleHeight","scale","innerHeight","top","style","marginTop","computedMainHeight","_this2","autoTextarea","setTimeout","EditableDiv","EmotionGrid","VHeader","v_header","Scroll","scroll_scroll","Emotion","destroyed","heightTimer","clearInterval","$store","commit","contentFocus","e","bottom","position","setInterval","contentBlur","first","_this3","scrollIntoView","scrollIntoViewIfNeeded","clientHeight","time","scroll","refresh","scrollTo","maxScrollY","sendMessage","textarea","JIM","getters","user","local","get","sendSingleMsg","target_username","chatObject","id","content","onSuccess","dispatch","msg_id","username","nickname","headUrl","contentType","sendTime","ctime_ms","axiosApi","post","userId","linkUrl","messageType","targetUrl","onFail","$vux","toast","onTimeout","toggoleEmotion","emotion","maxHeight","extra","elem","isFirefox","getBoxObjectFor","isOpera","opera","addEvent","callback","addEventListener","attachEvent","getStyle","currentStyle","val","search","rect","getBoundingClientRect","parseFloat","getComputedStyle","resize","change","padding","_length","parseInt","minHeight","scrollHeight","overflowY","currHeight","chatMsgList","newVal","oldVal","_this4","forEach","moment","diff","sendTimeStr","format","_this5","chat_chat","title","fixed","staticStyle","overflow","msg","class","_e","directives","rawName","expression","display","width","modifiers","trim","keyup","_k","keyCode","blur","$forceUpdate","target","composing","aria-hidden","stopPropagation","margin-top","chat_Component","chat_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/4.6aa72dfd9f91e78305ff.js","sourcesContent":["//\n//\n//\n//\n\r\nexport default {\r\n  name: 'editDiv',\r\n  props: {\r\n    value: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    canEdit: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      innerText: this.value,\r\n      isLocked: false\r\n    }\r\n  },\r\n  watch: {\r\n    'value' (newValue, oldValue) {\r\n      this.innerText = newValue\r\n      this.$nextTick(() => {\r\n        this.setCaretPosition()\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    changeText () {\r\n      this.$emit('input', this.$el.innerHTML)\r\n    },\r\n    setCaretPosition () {  // 设置光标到末尾\r\n      const obj = this.$refs.editDiv\r\n      let range\r\n      if (window.getSelection) {\r\n        obj.focus()\r\n        range = window.getSelection()\r\n        range.selectAllChildren(obj)\r\n        range.collapseToEnd()\r\n      } else if (document.selection) {\r\n        range = document.selection.createRange()\r\n        range.moveToElementText(obj)\r\n        range.collapse(false)\r\n        range.select()\r\n      }\r\n    },\r\n    getCursortPosition () {\r\n      const element = this.$refs.editDiv\r\n      var caretOffset = 0\r\n      var doc = element.ownerDocument || element.document\r\n      var win = doc.defaultView || doc.parentWindow\r\n      var sel\r\n      if (win.getSelection != null) { // 谷歌、火狐\r\n        sel = win.getSelection()\r\n        if (sel.rangeCount > 0) { // 选中的区域\r\n          var range = win.getSelection().getRangeAt(0)\r\n          var preCaretRange = range.cloneRange() // 克隆一个选中区域\r\n          preCaretRange.selectNodeContents(element) // 设置选中区域的节点内容为当前节点\r\n          preCaretRange.setEnd(range.endContainer, range.endOffset)  // 重置选中区域的结束位置\r\n          caretOffset = preCaretRange.toString().length\r\n        }\r\n      } else if ((sel = doc.selection) && sel.type !== 'Control') { // IE\r\n        var textRange = sel.createRange()\r\n        var preCaretTextRange = doc.body.createTextRange()\r\n        preCaretTextRange.moveToElementText(element)\r\n        preCaretTextRange.setEndPoint('EndToEnd', textRange)\r\n        caretOffset = preCaretTextRange.text.length\r\n      }\r\n      return caretOffset\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/chat/editableDiv.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"editDiv\",staticClass:\"edit-div needsclick\",attrs:{\"contenteditable\":_vm.canEdit},domProps:{\"innerHTML\":_vm._s(_vm.innerText)},on:{\"input\":_vm.changeText}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1427c208\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/chat/editableDiv.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1427c208\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./editableDiv.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./editableDiv.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./editableDiv.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1427c208\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../../node_modules/vux-loader/src/template-loader.js!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./editableDiv.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/chat/editableDiv.vue\n// module id = null\n// module chunks = ","\nimport Grid from 'vux/src/components/grid/grid.vue'\nimport GridItem from 'vux/src/components/grid/grid-item.vue'\n\nimport Slider from '../slider/slider'\n\nexport default {\ncomponents: {\nGrid,\nGridItem,\nSlider\n},\ndata () {\nreturn {\nemotionList: [\n['😂', '🙏', '😄', '😏', '😇', '😅', '😌', '😘', '😍', '🤓', '😜', '😎', '😊', '😳', '🙄', '😱', '😒', '😔', '😷', '👿', '🤗', '😩', '😤', '😣', '😰', '😴', '😬', '😭'],\n['👻', '👍', '✌️', '👉', '👀', '🐶', '🐷', '🤖', '⚡️', '🔥', '🌈', '🍏', '⚽️', '❤️', '🚘', '🌲', '🌚', '🌝', '🌰', '🦁', '🐼']\n]\n}\n},\nmethods: {\nclickEmotion (type) {\nthis.$emit('clickEmotion', type)\n}\n}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/chat/emotionGrid.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"emotion-grid\"},[_c('slider',{attrs:{\"list\":_vm.emotionList,\"autoPlay\":false,\"loop\":false}},_vm._l((_vm.emotionList),function(line,index1){return _c('grid',{key:index1,attrs:{\"cols\":7}},_vm._l((line),function(item,index){return _c('grid-item',{key:index,nativeOn:{\"click\":function($event){_vm.clickEmotion(item)}}},[_c('div',{staticClass:\"item\"},[_vm._v(_vm._s(item))])])}))}))],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-75fb64f2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/chat/emotionGrid.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-75fb64f2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./emotionGrid.vue\")\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-75fb64f2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector?type=styles&index=1!./emotionGrid.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./emotionGrid.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./emotionGrid.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-75fb64f2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../../node_modules/vux-loader/src/template-loader.js!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./emotionGrid.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-75fb64f2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/chat/emotionGrid.vue\n// module id = null\n// module chunks = ","//\n//\n//\n//\n\n// gif https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/5.gif\n// whole https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/default218877.gif\n// http://res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/emotion/icon_emotion_switch.2x278965.png\n// http://res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/icon/appmsg/emotion/icon_emotion_switch_active.2x278965.png\nconst list = ['微笑', '撇嘴', '色', '发呆', '得意', '流泪', '害羞', '闭嘴', '睡', '大哭', '尴尬', '发怒', '调皮', '呲牙', '惊讶', '难过', '酷', '冷汗', '抓狂', '吐', '偷笑', '可爱', '白眼', '傲慢', '饥饿', '困', '惊恐', '流汗', '憨笑', '大兵', '奋斗', '咒骂', '疑问', '嘘', '晕', '折磨', '衰', '骷髅', '敲打', '再见', '擦汗', '抠鼻', '鼓掌', '糗大了', '坏笑', '左哼哼', '右哼哼', '哈欠', '鄙视', '委屈', '快哭了', '阴险', '亲亲', '吓', '可怜', '菜刀', '西瓜', '啤酒', '篮球', '乒乓', '咖啡', '饭', '猪头', '玫瑰', '凋谢', '示爱', '爱心', '心碎', '蛋糕', '闪电', '炸弹', '刀', '足球', '瓢虫', '便便', '月亮', '太阳', '礼物', '拥抱', '强', '弱', '握手', '胜利', '抱拳', '勾引', '拳头', '差劲', '爱你', 'NO', 'OK', '爱情', '飞吻', '跳跳', '发抖', '怄火', '转圈', '磕头', '回头', '跳绳', '挥手', '激动', '街舞', '献吻', '左太极', '右太极']\n\nexport default {\n  name: 'wechat-emotion',\n  mounted () {\n    const name = this.$el.innerHTML\n    this.index = list.indexOf(name)\n    this.backgroundPositionX = -this.index * 24\n    let imgHTML = ''\n    if (!this.isGif) {\n      imgHTML = `<span class=\"vux-static-emotion\" style=\"background:url(https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/default218877.gif) ${this.backgroundPositionX}px 0;\"></span>`\n    } else {\n      imgHTML = `<img src=\"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/${this.index}.gif\">`\n    }\n    this.$nextTick(() => {\n      this.$el.innerHTML = imgHTML\n    })\n  },\n  props: {\n    isGif: Boolean\n  },\n  data () {\n    return {\n      src: '',\n      backgroundPositionX: 0\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/vux/src/components/wechat-emotion/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"vux-emotion\"},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-402903c8\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vux/src/components/wechat-emotion/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-402903c8\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../vux-loader/src/style-loader.js!../../../../vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../../vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../vux-loader/src/script-loader.js!../../../../vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../vux-loader/src/script-loader.js!../../../../vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-402903c8\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../vux-loader/src/before-template-compiler-loader.js!../../../../vux-loader/src/template-loader.js!../../../../vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vux/src/components/wechat-emotion/index.vue\n// module id = null\n// module chunks = ","\nimport { localUser } from '@/assets/js/local'\nimport { isIOS, isIphoneX } from '@/assets/js/brower'\nimport axios from '@/api/axiosApi'\n\nimport VHeader from '@/components/v-header/v-header'\nimport Scroll from '@/components/scroll/scroll'\nimport EditableDiv from './editableDiv'\nimport EmotionGrid from './emotionGrid'\nimport Emotion from 'vux/src/components/wechat-emotion/index.vue'\n\nimport { mapGetters } from 'vuex'\n\nexport default {\ndata () {\nreturn {\nshowEmotion: true,\nmainHeight: '',\ninputContent: '',\nsoftHeight: 0,   // 软键盘高度\nstatusBarHeight: 20,   // 状态栏高度\nmarginBottom: 0\n}\n},\ncomputed: {\n...mapGetters([\n'JIM', 'chatObject', 'chatMsgList'\n])\n},\ncreated () {\nthis.inputWidth = window.innerWidth - 55 - 24 - 12\nif (isIphoneX()) {\nthis.statusBarHeight = 44\nthis.marginBottom = 34\nthis.topHeight = 74\n} else {\nthis.topHeight = 60\n}\nwindow._Native_heightChange = (height, visibleHeight) => {\n\nconst scale = height / window.innerHeight \nif ((height - visibleHeight) / scale <= this.statusBarHeight) {\nthis.softHeight = 0\nthis.$refs.top.$el.style.marginTop = '0'\nif (isIphoneX()) {\nthis.marginBottom = 34\n}\n} else {\nthis.marginBottom = 0\nif (isIOS()) {\nthis.softHeight = (height - visibleHeight) / scale\n} else {\nthis.softHeight = (height - visibleHeight) / scale - this.statusBarHeight\n}\nthis.showEmotion = false\n}\nthis.computedMainHeight()\n}\n},\nmounted() {\nthis.autoTextarea(63, 0)\nsetTimeout(() => {\nthis.showEmotion = false\nthis.$nextTick(() => {\nthis.computedMainHeight(true)\n})\n}, 300)\n},\ncomponents: {\nEditableDiv, EmotionGrid, VHeader, Scroll, Emotion\n},\ndestroyed () {\nif (this.heightTimer) {\nclearInterval(this.heightTimer)\n}\nthis.$store.commit('SET_CHAT_OBJECT', {})\n},\nmethods: {\ncontentFocus (e) {\nif (isIOS()) {\nthis.$refs.bottom.style.position = 'fixed'\n}\nconst _self = this\n\nthis.heightTimer = setInterval(() => {\n_self.computedMainHeight()\n}, 200)\n},\ncontentBlur () {\nclearInterval(this.heightTimer)\n},\ncomputedMainHeight(first) {\nif (this.$refs.bottom) {\nthis.$refs.bottom.style.position = 'relative'\nthis.$refs.bottom.scrollIntoView()\nthis.$refs.bottom.scrollIntoViewIfNeeded()\nthis.$refs.bottom.style.bottom = '0'\nthis.mainHeight = window.innerHeight - this.$refs.top.$el.clientHeight - this.$refs.bottom.clientHeight - this.softHeight - this.marginBottom\n}\nlet time = 300\nif (first) {\ntime = 0\n}\nthis.$nextTick(() => {\nif (this.$refs.scroll) {\nthis.$refs.scroll.$el.style.marginTop = this.$refs.top.$el.clientHeight + 'px'\nsetTimeout(() => {\nif (this.$refs.scroll) {\nthis.$refs.scroll.scroll.refresh()\nthis.$refs.scroll.scroll.scrollTo(0, this.$refs.scroll.scroll.maxScrollY, time)\n}\n}, time)\n}\n})\n},\nsendMessage () {\nif (this.inputContent === '') {\nreturn\n}\nconst value = this.inputContent\nthis.inputContent = ''\nthis.$refs.textarea.focus()\nconst _self = this\nconst JIM = this.$store.getters.JIM\nconst user = localUser.get()\nJIM.sendSingleMsg({\n'target_username': _self.chatObject.id,\n'content': value\n}).onSuccess(function (data) {\n_self.$store.dispatch('sendMsg', {\nid: data.msg_id,\ntype: 'to',\nusername: _self.chatObject.id,\nnickname: user.nickname,\nheadUrl: user.headUrl,\ncontent: value,\ncontentType: 0,\nsendTime: data.ctime_ms\n})\naxios.post(_self, '/v1/pushAlias', {\nuserId: _self.chatObject.id,\ncontent: `${localUser.get('nickname')}: ${value}`,\nlinkUrl: `/user/focus`,\nmessageType: 1,\ntargetUrl: '/user'\n})\n}).onFail(function (data) {\n_self.$vux.toast.text('发送失败', 'middle')\n}).onTimeout(function (data) {\n_self.$vux.toast.text('发送超时', 'middle')\n})\n},\ntoggoleEmotion () {\nthis.showEmotion = !this.showEmotion\n},\nclickEmotion (emotion) {\nthis.inputContent += emotion\n},\nautoTextarea (maxHeight, extra) {\n\nconst elem = this.$refs.textarea\nextra = extra || 0\nconst isFirefox = !!document.getBoxObjectFor || 'mozInnerScreenX' in window\nconst isOpera = !!window.opera && !!window.opera.toString().indexOf('Opera')\nconst addEvent = function (type, callback) {\nelem.addEventListener ? elem.addEventListener(type, callback, false) : elem.attachEvent('on' + type, callback)\n}\nconst getStyle = elem.currentStyle ? function (name) {\nvar val = elem.currentStyle[name]\nif (name === 'height' && val.search(/px/i) !== 1) {\nvar rect = elem.getBoundingClientRect()\nreturn rect.bottom - rect.top - parseFloat(getStyle('paddingTop')) - parseFloat(getStyle('paddingBottom')) + 'px'\n}\nreturn val\n} : function (name) {\nreturn getComputedStyle(elem, null)[name]\n}\nconst minHeight = 26\nelem.style.resize = 'none'\nconst change = function () {\nlet height\nlet padding = 0\nlet style = elem.style\nif (elem._length === elem.value.length) return\nelem._length = elem.value.length\nif (!isFirefox && !isOpera) {\npadding = parseInt(getStyle('paddingTop')) + parseInt(getStyle('paddingBottom'))\n}\n\nelem.style.height = minHeight + 'px'\nif (elem.scrollHeight > minHeight) {\nif (maxHeight && elem.scrollHeight > maxHeight) {\nheight = maxHeight - padding\nstyle.overflowY = 'visible'\n} else {\nheight = elem.scrollHeight - padding\nstyle.overflowY = 'hidden'\n};\nstyle.height = height + extra + 'px'\nelem.currHeight = parseInt(style.height)\n}\n}\naddEvent('propertychange', change)\naddEvent('input', change)\naddEvent('focus', change)\nchange()\n}\n},\nwatch: {\nchatMsgList (newVal, oldVal) {\n\nnewVal.forEach((item, index) => {\nif (this.moment().diff(this.moment(item.sendTime), 'days') <= 1) {\nitem.sendTimeStr = this.moment(item.sendTime).format('HH:mm')\n} else {\nitem.sendTimeStr = this.moment(item.sendTime).format('YYYY-MM-DD HH:mm')\n}\nif (index > 0) {\nif (this.moment(item.sendTime).diff(this.moment(newVal[index - 1].sendTime), 'minutes') < 4) {\nitem.sendTimeStr = ''\n}\n}\n})\n},\nshowEmotion () {\nthis.$nextTick(() => {\nthis.computedMainHeight()\n})\n}\n}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/chat/chat.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat-wrapper\"},[_c('v-header',{ref:\"top\",attrs:{\"title\":_vm.chatObject.nickname,\"fixed\":true}}),_vm._v(\" \"),_c('scroll',{ref:\"scroll\",staticStyle:{\"overflow\":\"hidden\"},style:({height: _vm.mainHeight + 'px', marginTop: _vm.topHeight + 'px'}),attrs:{\"data\":_vm.chatMsgList}},[_c('ul',{staticClass:\"message\"},_vm._l((_vm.chatMsgList),function(msg){return _c('li',{key:msg.id,class:msg.type},[(msg.sendTimeStr !== '')?_c('p',{staticClass:\"time\"},[_c('span',[_vm._v(_vm._s(msg.sendTimeStr))])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"main\"},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(msg.headUrl),expression:\"msg.headUrl\"}],staticClass:\"avatar\"}),_vm._v(\" \"),_c('div',{staticClass:\"text\",domProps:{\"innerHTML\":_vm._s(msg.content)}})])])}))]),_vm._v(\" \"),_c('div',{ref:\"bottom\",staticClass:\"bottom\"},[_c('div',{staticStyle:{\"display\":\"flex\"}},[_c('div',{staticClass:\"input\",style:({width: _vm.inputWidth + 'px'})},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.inputContent),expression:\"inputContent\",modifiers:{\"trim\":true}}],ref:\"textarea\",domProps:{\"value\":(_vm.inputContent)},on:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key)){ return null; }_vm.sendMessage($event)},\"focus\":_vm.contentFocus,\"blur\":[_vm.contentBlur,function($event){_vm.$forceUpdate()}],\"input\":function($event){if($event.target.composing){ return; }_vm.inputContent=$event.target.value.trim()}}}),_vm._v(\" \"),_c('i',{staticClass:\"fa fa-smile-o emoji\",attrs:{\"aria-hidden\":\"true\"},on:{\"click\":function($event){$event.stopPropagation();_vm.toggoleEmotion($event)}}})]),_vm._v(\" \"),_c('p',{staticClass:\"send\",on:{\"click\":_vm.sendMessage}},[_vm._v(\"发送\")])]),_vm._v(\" \"),_c('emotion-grid',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showEmotion),expression:\"showEmotion\"}],staticStyle:{\"margin-top\":\"7px\"},on:{\"clickEmotion\":_vm.clickEmotion}})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-d98e1b2c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/chat/chat.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-d98e1b2c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./chat.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-d98e1b2c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../../node_modules/vux-loader/src/template-loader.js!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./chat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-d98e1b2c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/chat/chat.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}